@tailwind base;
@tailwind components;
@tailwind utilities;

/* Base HTML/Body styles */
html, body, #root {
  @apply w-full h-full m-0 p-0 box-border font-sans bg-gray-50 dark:bg-dark-bg;
}

/* Dark mode variable overrides for React Flow */
.dark {
  --xy-edge-stroke-default: #e0e0e0;
  --xy-edge-stroke-width-default: 1.5;
  --xy-edge-stroke-selected-default: #60a5fa;
  --xy-connectionline-stroke-default: #60a5fa;
  --xy-connectionline-stroke-width-default: 1.5;
  --xy-attribution-background-color-default: rgba(45, 45, 45, 0.8);
  --xy-minimap-background-color-default: #262626;
  --xy-background-pattern-dots-color-default: #525252;
  --xy-background-pattern-line-color-default: #404040;
  --xy-background-pattern-cross-color-default: #404040;
  --xy-node-color-default: #e5e7eb;
  --xy-node-border-default: 1px solid #404040;
  --xy-node-background-color-default: #171717;
  --xy-node-boxshadow-hover-default: 0 1px 6px 1px rgba(0, 0, 0, 0.3);
  --xy-node-boxshadow-selected-default: 0 0 0 2px #60a5fa;
  --xy-handle-background-color-default: #60a5fa;
  --xy-handle-border-color-default: #171717;
  --xy-selection-background-color-default: rgba(96, 165, 250, 0.1);
  --xy-selection-border-default: 1px solid rgba(96, 165, 250, 0.8);
  --xy-controls-button-background-color-default: #262626;
  --xy-controls-button-background-color-hover-default: #404040;
  --xy-controls-button-color-default: #e5e7eb;
  --xy-controls-button-color-hover-default: #ffffff;
  --xy-controls-button-border-color-default: #404040;
  --xy-controls-box-shadow-default: 0 0 6px 1px rgba(0, 0, 0, 0.2);
}

/* React Flow Customizations */
@layer components {
    /* Base styling for any custom node, if DialogueNode is used directly */
    .dialogue-node-base {
        @apply p-3 border rounded-md shadow-sm text-left
               min-w-[180px]
               whitespace-normal
               break-words
               overflow-hidden
               transition-all duration-200
               bg-white dark:bg-dark-surface
               border-gray-300 dark:border-dark-border
               text-gray-800 dark:text-dark-text;
    }

    /* Universal Selection Style for Nodes */
    .react-flow__node.selected > .dialogue-node-base, /* Generic base */
    .react-flow__node.selected > .npc-node,         /* Specific NPC node */
    .react-flow__node.selected > .user-node,         /* Specific User node */
    .react-flow__node.selected > .node-input-styled { /* Start node */
        @apply border-2 border-blue-500 dark:border-blue-400 ring-2 ring-offset-1 ring-blue-500 dark:ring-blue-400 ring-offset-white dark:ring-offset-dark-bg;
    }

    /* Handle Styling */
    .react-flow__handle {
        @apply !w-3 !h-3 !border-none transition-colors duration-200;
        @apply !bg-gray-400 dark:!bg-gray-500; /* Default handle color */
    }
    .react-flow__handle:hover {
        @apply !bg-blue-500 dark:!bg-blue-400; /* Hover handle color */
    }
    .npc-node .react-flow__handle,
    .user-node .react-flow__handle {
        @apply !bg-blue-500 dark:!bg-blue-400; /* Specific nodes use consistent theme color */
    }
    .react-flow__handle.connectable { @apply cursor-crosshair; }
    .react-flow__handle.connecting { @apply !bg-green-500; }
    .react-flow__handle.valid { @apply !bg-green-500; }


    /* Dark mode adjustments for other flow elements */
    .dark .react-flow__controls {
        @apply bg-dark-surface border border-dark-border rounded-lg overflow-hidden shadow-lg;
    }
    .dark .react-flow__controls-button {
        @apply bg-dark-surface text-white border-dark-border hover:bg-dark-border;
    }
    .dark .react-flow__controls-button svg {
        @apply text-white fill-white stroke-white;
    }
    .dark .react-flow__minimap {
        @apply bg-dark-surface border border-dark-border rounded-lg overflow-hidden shadow-lg;
    }
    .dark .react-flow__minimap-node {
        @apply fill-dark-accent stroke-dark-border;
    }
    .dark .react-flow__minimap-mask {
        @apply fill-dark-bg opacity-50;
    }
    .dark .react-flow__attribution {
        @apply text-dark-text bg-dark-panel px-2 py-1 rounded;
    }
    .dark .react-flow__background {
        @apply opacity-30;
    }
    .dark .react-flow__edge-path {
        @apply stroke-dark-text stroke-[1.5px];
    }
    .dark .react-flow__edge.selected .react-flow__edge-path {
        @apply stroke-dark-accent stroke-2;
    }
    .dark .react-flow__edge.animated .react-flow__edge-path {
        @apply stroke-dark-accent;
    }
    .dark .react-flow__connection-path {
        @apply stroke-dark-accent stroke-[1.5px];
    }
    .dark .react-flow__selection {
        @apply border border-dark-accent bg-dark-accent bg-opacity-10;
    }
}

/* Scrollbar Styles */
.card-scrollbar::-webkit-scrollbar { width: 5px; }
.card-scrollbar::-webkit-scrollbar-track {
  background-color: rgba(239, 246, 255, 0.6); /* Light theme track */
  border-radius: 8px;
}
.card-scrollbar::-webkit-scrollbar-thumb {
  background-color: rgba(96, 165, 250, 0.6); /* Light theme thumb */
  border-radius: 8px;
}
.card-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: rgba(59, 130, 246, 0.8); /* Light theme thumb hover */
}
.dark .card-scrollbar::-webkit-scrollbar-track {
  background-color: rgba(31, 41, 55, 0.3); /* Dark theme track (slightly visible gray) */
}
.dark .card-scrollbar::-webkit-scrollbar-thumb {
  background-color: rgba(96, 165, 250, 0.4); /* Dark theme thumb */
}
.dark .card-scrollbar::-webkit-scrollbar-thumb:hover {
   background-color: rgba(96, 165, 250, 0.6); /* Dark theme thumb hover */
}
/* Firefox scrollbar */
.card-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: rgba(96, 165, 250, 0.6) rgba(239, 246, 255, 0.6); /* thumb track */
}
.dark .card-scrollbar {
  scrollbar-color: rgba(96, 165, 250, 0.4) rgba(31, 41, 55, 0.3); /* thumb track */
}